<!DOCTYPE html>
<html lang="fr">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

	<!-- Bootstrap CSS -->
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">

	<title>Happy New Year !</title>
	<!-- Global site tag (gtag.js) — Google Analytics -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=G-D8VGV2T8YH"></script>
	<script>
      window.dataLayer = window.dataLayer || [];

      function gtag() {
          dataLayer.push(arguments);
      }

      gtag('js', new Date());

      gtag('config', 'G-D8VGV2T8YH');
	</script>
	<script src='javascript/winwheel/Winwheel.min.js'></script>
	<script src='javascript/TweenMax.min.js'></script>

	<link rel="stylesheet" href="css/styles.css"/>
</head>
<body class="position-relative" style="overflow-x: hidden">
<!-- RIGHT HIDDEN STAR -->
<img src="/images/fond-etoile-petite.png" alt="star" class="bling-bling bigger" style="right: -25px; top: 50%"/>

<!-- TOP RIGHT STARS -->
<img src="/images/fond-etoile-petite.png" alt="star" class="bling-bling smaller" style="right: 22%; top: 5%"/>
<img src="/images/fond-etoile-petite.png" alt="star" class="bling-bling smaller" style="right: 15%; top: 15%"/>
<img src="/images/fond-etoile-petite.png" alt="star" class="bling-bling bigger" style="right: 17%; top: 15px"/>

<!-- RIGHT BOTTOM STARS -->
<img src="/images/fond-etoile-petite.png" alt="star" class="bling-bling bigger" style="right: 16%; bottom: 12%"/>
<img src="/images/fond-etoile-petite.png" alt="star" class="bling-bling smaller" style="right: 15%; bottom: 9%"/>
<img src="/images/fond-etoile-petite.png" alt="star" class="bling-bling smaller" style="right: 19%; bottom: 8%"/>

<!-- LEFT BOTTOM STARS -->
<img src="/images/fond-etoile-petite.png" alt="star" class="bling-bling bigger" style="left: 45%; bottom: 16%"/>
<img src="/images/fond-etoile-petite.png" alt="star" class="bling-bling smaller" style="left: 42%; bottom: 8%"/>
<img src="/images/fond-etoile-petite.png" alt="star" class="bling-bling smaller" style="left: 50%; bottom: 11%"/>
<img src="/images/fond-etoile-petite.png" alt="star" class="bling-bling smaller" style="left: 19%; bottom: 8%"/>

<!-- TOP LEFT STARS -->
<img src="/images/fond-etoile-petite.png" alt="star" class="bling-bling bigger" style="left: 20%; top: 5%"/>
<img src="/images/fond-etoile-petite.png" alt="star" class="bling-bling smaller" style="left: 30%; top: 0"/>
<img src="/images/fond-etoile-petite.png" alt="star" class="bling-bling bigger" style="left: 50%; top: 6%"/>
<img src="/images/fond-etoile-petite.png" alt="star" class="bling-bling smaller" style="left: 52%; top: 8%"/>

<div class="container app d-flex d-lg-block align-items-center justify-content-center">
	<div class="row align-items-lg-center">
		<div class="col-lg-4 text-center text-lg-left d-lg-flex justify-content-lg-center">
			<div>
				<h1 class="title">Prêt pour 2021 ?</h1>
				<h5>Néo-Soft vous lit l’avenir</h5>
				<div class="d-sm-none d-none d-lg-block mt-5">
					<button onclick="startSpin()" class="btn btn-lg text-light">Tourner la roue</button>
				</div>
			</div>
		</div>

		<div class="col-lg-8 vh-100 my-4 my-lg-0 d-flex align-items-center">
			<div class="wheel-container d-flex justify-content-center align-items-center h-100 position-relative embed-responsive embed-responsive-1by1">
				<canvas
					id="canvas"
					height="600"
					width="600"
					class="embed-responsive-item"
					data-responsiveMinWidth="180"
					data-responsiveScaleHeight="true"
					data-responsiveMargin="50"
				>
					Canvas not supported on this browser. Please use another one.
				</canvas>

				<img
					src="/images/roue-pointeur.png"
					alt="Le pointeur de la roue"
					id="pointer"
					class="position-absolute img-fluid"
				/>
			</div>
		</div>

		<div class="col-lg-6 d-block d-lg-none text-center">
			<button onclick="startSpin()" class="btn btn-lg text-light">Tourner la roue</button>
		</div>
	</div>
</div>

<div class="modal fade" id="welcome-popup" tabindex="-1" data-backdrop="static" aria-hidden="true"
		 data-keyboard="false">
	<div class="modal-dialog modal-dialog-centered">
		<div class="modal-content">
			<div class="modal-body text-center">
				<div class="d-flex justify-content-center align-items-center h-100">
					<div class="p-3">
						<div class="h1 font-weight-bold mb-5">Néo-Soft vous souhaite une excellente <br>année 2021 !</div>
						<p class="h3 mb-5">Tournez la roue et découvrez ce que cette nouvelle année <br>vous réserve...</p>
						<div class="p-4 stars-square">
							<button onclick="hideWelcomePopup()" class="btn btn-lg text-light" style="width: 185px">Commencer</button>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>

<div class="modal fade" id="result-popup" tabindex="-1" data-backdrop="static" aria-hidden="true" data-keyboard="false">
	<div class="modal-dialog modal-dialog-centered">
		<div class="modal-content">
			<div class="modal-body text-center">
				<div class="d-flex justify-content-center align-items-center h-100">
					<div class="p-3">
						<img src="/images/roue-centre.png" alt="" class="mb-5 img-thumbnail"/>
						<p class="h3 mb-5">En 2021, vos tartines ne tomberont plus sur le côté confiture, promis.</p>
						<div class="p-3">
							<button onclick="hideResultPopup()" class="btn btn-lg text-light" style="width: 185px">Recommencer</button>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>

<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.20/lodash.min.js" integrity="sha512-90vH1Z83AJY9DmlWa8WkjkV79yfS2n2Oxhsi2dZbIv0nC4E6m5AbH8Nh156kkM7JePmqD6tcZsfad1ueoaovww==" crossorigin="anonymous"></script>

<script>
    window.onload = setUp;
    function setUp() {
        $('#result-popup')
            .on('hidden.bs.modal', resetResultModal);

        showWelcomePopup();
    }

    // The responsive parameter is the only difference needed to make a wheel responsive.
    const theWheel = new Winwheel({
        'numSegments': 8,
        'responsive': true,  // This wheel is responsive!
        'drawText': false,
        'drawMode': 'segmentImage',
				outerRadius: 250,
        'segments': [
            {'image': 'images/roue-portion1.png', 'text': 'sac'},
            {'image': 'images/roue-portion2.png', 'text': 'video'},
            {'image': 'images/roue-portion3.png', 'text': 'pierre'},
            {'image': 'images/roue-portion4.png', 'text': 'tete'},
            {'image': 'images/roue-portion5.png', 'text': 'fleur'},
            {'image': 'images/roue-portion6.png', 'text': 'bras'},
            {'image': 'images/roue-portion7.png', 'text': 'assiete'},
            {'image': 'images/roue-portion8.png', 'text': 'coeur'}
        ],
        'animation': {
            'type': 'spinToStop',
            'duration': 5,
            'spins': 8,
            callbackFinished: showResultPopup
        }
    });

    // Called by the onClick of the canvas, starts the spinning.
    function startSpin() {
        // Stop any current animation.
        theWheel.stopAnimation(false);

        // Reset the rotation angle to less than or equal to 360 so spinning again works as expected.
        // Setting to modulus (%) 360 keeps the current position.
        theWheel.rotationAngle = theWheel.rotationAngle % 360;

        // Start animation.
        theWheel.startAnimation();
    }

    function showResultPopup() {
        $('#pointer').addClass('bounce');

        setTimeout(() => {
            const winSegment = theWheel.getIndicatedSegment();
            $('#result-popup')
                .on('show.bs.modal', _.partial(updateResultModal, winSegment))
                .modal('show');
				}, 1500)
    }

    function showWelcomePopup() {
        $('#welcome-popup').modal('show');
    }

    function hideWelcomePopup() {
        $('#welcome-popup').modal('hide');
    }

    function hideResultPopup() {
				$('#result-popup').modal('hide');
    }

    function updateResultModal(segment, $event = null) {
        $(this).find('p.h3').text(segment.text);
		}

		function resetResultModal($event = null) {
        $('#pointer').removeClass('bounce');

        $(this).find('p.h3').text(null);
    }
</script>
</body>
</html>
