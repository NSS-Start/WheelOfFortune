<!DOCTYPE html>
<html lang="fr">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

	<!-- Bootstrap CSS -->
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
				integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">

	<title>Happy New Year !</title>
	<!-- Global site tag (gtag.js) — Google Analytics -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=G-D8VGV2T8YH"></script>
	<script>
      window.dataLayer = window.dataLayer || [];

      function gtag() {
          dataLayer.push(arguments);
      }

      gtag('js', new Date());

      gtag('config', 'G-D8VGV2T8YH');
	</script>
	<script src='javascript/winwheel/Winwheel.min.js'></script>
	<script src='javascript/TweenMax.min.js'></script>

	<link rel="stylesheet" href="css/styles.css"/>
</head>
<body class="position-relative">
<img src="/images/fond-rayons.png" alt="fond-rayons" id="fond-rayons"/>
<img src="/images/fond-etoile-petite.png" alt="star" class="bling-bling bigger d-none d-lg-block" style="right: 5%; top: 50%"/>

<!-- TOP LEFT STARS -->
<img src="/images/fond-etoile-petite.png" alt="star" class="bling-bling bigger d-none d-lg-block"
		 style="left: 20%; top: 5%"/>
<img src="/images/fond-etoile-petite.png" alt="star" class="bling-bling smaller d-none d-lg-block" style="left: 30%; top: 0"/>

<div class="container app d-flex d-lg-block align-items-center justify-content-center position-relative">
	<img src="/images/fond-forme1-rond.png" alt="forme rond" class="d-none d-lg-block forme-rond"/>
	<img src="/images/fond-forme2-points.png" alt="forme point 1" class="forme-point-1"/>
	<img src="/images/fond-forme2-points.png" alt="forme point 2" class="forme-point-2"/>

	<!-- LEFT BOTTOM STARS -->
	<img src="/images/fond-etoile-petite.png" alt="star" class="bling-bling smaller" style="left: 30%; bottom: 23%"/>
	<img src="/images/fond-etoile-petite.png" alt="star" class="bling-bling smaller" style="left: 19%; bottom: 8%"/>

	<div class="row align-items-lg-center">
		<div class="col-lg-4 text-center text-lg-left d-lg-flex justify-content-lg-center">
			<div>
				<h1 class="title">Prêt pour 2021 ?</h1>
				<h5>Néo-Soft vous lit l’avenir</h5>
				<div class="d-sm-none d-none d-lg-block mt-5">
					<button onclick="startSpin()" class="btn btn-lg text-light cta-bleu">Tourner la roue</button>
				</div>
			</div>
		</div>

		<div class="col-lg-8 vh-100 my-0 d-flex align-items-center">
			<!-- RIGHT BOTTOM STARS -->
			<img src="/images/fond-etoile-petite.png" alt="star" class="bling-bling bigger" style="right: 10%; bottom: 30%"/>
			<img src="/images/fond-etoile-petite.png" alt="star" class="bling-bling smaller" style="right: 5%; bottom: 17%"/>
			<img src="/images/fond-etoile-petite.png" alt="star" class="bling-bling smaller" style="right: 25%; bottom: 12%"/>

			<!-- TOP RIGHT STARS -->
			<img src="/images/fond-etoile-petite.png" alt="star" class="bling-bling smaller" style="right: 8%; top: 25%"/>
			<img src="/images/fond-etoile-petite.png" alt="star" class="bling-bling smaller" style="right: 35%; top: 10%"/>
			<img src="/images/fond-etoile-petite.png" alt="star" class="bling-bling bigger"
					 style="right: 17%; top: 15px"/>

			<img src="/images/fond-etoile-petite.png" alt="star" class="bling-bling smaller" style="left: 10%; bottom: 30%"/>
			<img src="/images/fond-etoile-petite.png" alt="star" class="bling-bling bigger d-none d-lg-block" style="left: 5%; bottom: 50%"/>

			<!-- TOP LEFT	-->
			<img src="/images/fond-etoile-petite.png" alt="star" class="bling-bling bigger"
					 style="left: 10%; top: 20%"/>
			<img src="/images/fond-etoile-petite.png" alt="star" class="bling-bling smaller"
					 style="left: 14%; top: 28%"/>

			<div class="wheel-container h-100 d-flex justify-content-center align-items-center position-relative">
				<div class="wheel-embed embed-responsive embed-responsive-1by1">
					<canvas
						id="canvas"
						height="600"
						width="600"
						class="embed-responsive-item"
						data-responsiveMinWidth="180"
						data-responsiveScaleHeight="true"
						data-responsiveMargin="50"
						onclick="startSpin()"
					>
						Canvas not supported on this browser. Please use another one.
					</canvas>

					<img
						src="/images/roue-pointeur.png"
						alt="Le pointeur de la roue"
						id="pointer"
					/>
					<img src="/images/roue-centre.png" alt="roue-centre" id="roue-centre"/>
				</div>
			</div>
		</div>

		<div class="col-lg-6 d-block d-lg-none text-center">
			<button onclick="startSpin()" class="btn btn-lg text-light cta-bleu">Tourner la roue</button>
		</div>
	</div>
</div>

<div class="modal fade" id="welcome-popup" tabindex="-1" data-backdrop="static" aria-hidden="true"
		 data-keyboard="false">
	<div class="modal-dialog modal-dialog-centered mx-auto">
		<div class="modal-content">
			<div class="modal-body shadow embed-responsive">
				<img src="/images/fond-rayons.png" alt="rayons" class="embed-responsive-item ray-opacity"/>
				<div class="px-2 px-lg-4 py-4 py-lg-5 text-center position-relative">
					<h5 class="modal-title">Néo-Soft vous souhaite une excellente année 2021 !</h5>
					<p class="lead mt-4">Tournez la roue et découvrez ce que cette nouvelle année vous réserve...</p>
					<div class="p-4 stars-square">
						<button onclick="hideWelcomePopup()" class="btn btn-lg text-light cta-bleu">&nbsp;&nbsp;&nbsp;Commencer&nbsp;&nbsp;&nbsp;</button>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>

<div class="modal fade" id="result-popup" tabindex="-1" data-backdrop="static" aria-hidden="true" data-keyboard="false">
	<div class="modal-dialog modal-dialog-centered mx-auto">
		<div class="modal-content" id="modal-content">
			<div class="modal-body shadow embed-responsive">
				<img src="/images/fond-rayons.png" alt="rayons" class="embed-responsive-item ray-opacity"/>
				<div class="px-2 px-lg-4 py-4 py-lg-5 text-center position-relative">
					<div class="w-25 d-inline-block">
						<img src="/images/roue-centre.png" alt="picto" id="picto" class="img-fluid rounded-circle mx-auto"/>
					</div>
					<p class="lead my-4" id="result-text">En 2021, vos tartines ne tomberont plus sur le côté confiture,
						promis.</p>
					<div class="p-3 stars-square">
						<button
							onclick="hideResultPopup()"
							class="btn btn-lg text-light">&nbsp;&nbsp;Recommencer&nbsp;&nbsp;</button>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>

<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
				integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
				crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js"
				integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx"
				crossorigin="anonymous"></script>

<script>
    window.onload = setUp;

    function setUp() {
        $('#result-popup')
            .on('show.bs.modal', updateResultModal)
            .on('hidden.bs.modal', resetResultModal);

        showWelcomePopup();
    }

    // The responsive parameter is the only difference needed to make a wheel responsive.
    const theWheel = new Winwheel({
        'numSegments': 8,
        'responsive': true,  // This wheel is responsive!
        'drawText': false,
        'drawMode': 'segmentImage',
        outerRadius: 250,
        'segments': [
            {
                'image': 'images/roue-portion1.png',
                'color': 'violet',
                'text': "En 2021, vous n'oublierez plus d'insérer la PJ dans votre e-mail.",
                'picto': 'picto-01.png'
            },
            {
                'image': 'images/roue-portion2.png',
                'color': 'bleu',
                'text': 'On le sent : cet été Les Gendarmes de St Tropez passeront à la télévision.',
                'picto': 'picto-02.png'
            },
            {
                'image': 'images/roue-portion3.png',
                'color': 'bleu-clair',
                'text': 'La richesse vous sourit : vous gagnerez plus de 2€ à votre ticket à gratter.',
                'picto': 'picto-03.png'
            },
            {
                'image': 'images/roue-portion4.png',
                'color': 'menthe',
                'text': "Cette année, vous rayonnez d'énergie ! Plus besoin de café, c'est lui qui a besoin de vous.",
                'picto': 'picto-04.png'
            },
            {
                'image': 'images/roue-portion5.png',
                'color': 'vert',
                'text': 'Félicitations, vous avez traversé 2020 ! Passez par la case départ et touchez 20 000€.',
                'picto': 'picto-05.png'
            },
            {
                'image': 'images/roue-portion6.png',
                'color': 'jaune',
                'text': "Team jogging & jus détox ou peignoir & Schoko-Bons ? Peu importe, votre body est déjà prêt pour l'été !",
                'picto': 'picto-06.png'
            },
            {
                'image': 'images/roue-portion7.png',
                'color': 'orange',
                'text': 'Cette année, vos tartines ne tomberont plus côté confiture, promis.',
                'picto': 'picto-07.png'
            },
            {
                'image': 'images/roue-portion8.png',
                'color': 'rose',
                'text': 'Une rencontre va changer votre vie ! Une personne ? Un petit chiot ? Qui a dit que nous étions médium ?',
                'picto': 'picto-08.png'
            }
        ],
        'animation': {
            'type': 'spinToStop',
            'duration': 2,
            'spins': 8,
            callbackFinished: showResultPopup
        }
    });

    // Called by the onClick of the canvas, starts the spinning.
    function startSpin() {
        // Stop any current animation.
        theWheel.stopAnimation(false);

        // Reset the rotation angle to less than or equal to 360 so spinning again works as expected.
        // Setting to modulus (%) 360 keeps the current position.
        theWheel.rotationAngle = theWheel.rotationAngle % 360;

        // Start animation.
        theWheel.startAnimation();
    }

    function showResultPopup() {
        $('#pointer').addClass('bounce');
        setTimeout(() => {
            $('#result-popup')
        				.modal('show');
        }, 500)
    }

    function showWelcomePopup() {
        $('#welcome-popup').modal('show');
    }

    function hideWelcomePopup() {
        $('#welcome-popup').modal('hide');
    }

    function hideResultPopup() {
        $('#result-popup').modal('hide');
    }

    function updateResultModal() {
        const modal = $(this);
        const segment = theWheel.getIndicatedSegment();

        modal.find('.modal-content').addClass(`bg-${segment.color}`)
        modal.find('#picto').attr('src', '/images/' + segment.picto);
        modal.find('#result-text').text(segment.text);
        modal.find('button').addClass(`cta-${segment.color}`)
    }

    function resetResultModal() {
        $('#pointer').removeClass('bounce');

        const modal = $(this);
        const segment = theWheel.getIndicatedSegment();

        modal.find('p.h3').text(null);
        modal.find('#modal-content').removeClass(`bg-${segment.color}`);
        modal.find('button').removeClass(`cta-${segment.color}`);
        // segment = null;
    }
</script>
</body>
</html>
